
pipeline {
    agent any


    stages {
            stage ('Build No') {
                    steps {
                        sh "echo 'build No. - $BUILD_NUMBER'"
                    }
                }
            stage ('Maven Install') {
                steps {
                    sh "/opt/maven/apache-maven-3.8.6/bin/mvn clean install"
                }
            }
            stage ('Maven Package : Artifact Upload') {
            steps {
                sh "/opt/maven/apache-maven-3.8.6/bin/mvn deploy -s settings.xml"
            }
        }

        stage ('Slack Notification') {
            steps {
            script {
            try{
                //Start sending build information
                    slackSend (channel: "devops", color: "#439FE0", message: "started ${env.JOB_NAME} ${env.BUILD_NUMBER} and Job URL - ${env.BUILD_URL}")
            }
            catch(Exception e){
                sh "echo 'Job Failed'"
                currentBuild.result = "FAILURE"
                slackSend (channel: "devops", color: "#439FE0", message: "Job Failed - ${env.JOB_NAME} ${env.BUILD_NUMBER} and Job URL - ${env.BUILD_URL}")
                }
              }
            }
        }
    }
    post {
        always{
            mail body: 'Jenkins Job  - ${BUILD_NAME}', cc: 'naresh.masurkar1@gmail.com', subject: 'Jenkins Job - $BUILD_NUMBER', to: 'naresh170690@rediffmail.com'
        }

    }

}
